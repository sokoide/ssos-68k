# QuickDrawã‚¹ã‚¿ã‚¤ãƒ«ã‚°ãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚¹ã‚·ã‚¹ãƒ†ãƒ ã¸ã®ç§»è¡Œãƒ—ãƒ©ãƒ³

ç¾åœ¨ã®è¤‡é›‘ãªãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚·ã‚¹ãƒ†ãƒ ã‚’68000 16MHzã«æœ€é©åŒ–ã•ã‚ŒãŸQuickDrawã‚¹ã‚¿ã‚¤ãƒ«ã«æ®µéšçš„ã«ç§»è¡Œã—ã¾ã™ã€‚å„ãƒ•ã‚§ãƒ¼ã‚ºã”ã¨ã«å®Ÿè£…ãƒ»ãƒ†ã‚¹ãƒˆãŒå¯èƒ½ã§ã€æ®µéšçš„ã«æ©Ÿèƒ½ã‚’è¿½åŠ ã—ã¦ã„ãã¾ã™ã€‚

## ğŸ—ï¸ ã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆ

**QuickDrawã‚¹ã‚¿ã‚¤ãƒ«ã®è¨­è¨ˆã‚³ãƒ³ã‚»ãƒ—ãƒˆ:**
- **ç›´æ¥æç”»**: VRAMã«å³æ™‚æç”»ï¼ˆãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒãƒƒãƒ•ã‚¡ä¸è¦ï¼‰
- **æ•´æ•°åº§æ¨™ç³»**: é«˜é€Ÿãªæ•´æ•°æ¼”ç®—ã®ã¿ä½¿ç”¨
- **16è‰²ãƒ‘ãƒ¬ãƒƒãƒˆ**: å›ºå®šãƒ‘ãƒ¬ãƒƒãƒˆã§ã‚«ãƒ©ãƒ¼ç®¡ç†
- **åŸºæœ¬ãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–**: ç‚¹ã€ç·šã€çŸ©å½¢ã€å¡—ã‚Šã¤ã¶ã—
- **ã‚¯ãƒªãƒƒãƒ”ãƒ³ã‚°**: çŸ©å½¢ãƒ™ãƒ¼ã‚¹ã®ã‚·ãƒ³ãƒ—ãƒ«ãªã‚¯ãƒªãƒƒãƒ”ãƒ³ã‚°

```mermaid
graph TB
    A[QuickDraw Graphics] --> B[Color Palette]
    A --> C[Drawing Primitives]
    A --> D[VRAM Direct Access]
    B --> E[16-Color Management]
    C --> F[Point/Line Drawing]
    C --> G[Rectangle Fill]
    C --> H[Pattern Fill]
    D --> I[Fast Pixel Access]
    D --> J[Block Transfer]
```

## ğŸ“‹ è©³ç´°ãªç§»è¡Œãƒ•ã‚§ãƒ¼ã‚º

### **ãƒ•ã‚§ãƒ¼ã‚º0: æº–å‚™ãƒ»åˆ†æ**
**ç›®çš„**: ç¾åœ¨ã®ã‚·ã‚¹ãƒ†ãƒ ã‚’ç†è§£ã—ã€ç§»è¡Œè¨ˆç”»ã‚’ç­–å®š
- âœ… ç¾åœ¨ã®ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚·ã‚¹ãƒ†ãƒ ã®å…¨æ©Ÿèƒ½ãƒãƒƒãƒ”ãƒ³ã‚°
- âœ… VRAMã‚¢ã‚¯ã‚»ã‚¹ãƒ‘ã‚¿ãƒ¼ãƒ³ã®åˆ†æ
- âœ… ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒœãƒˆãƒ«ãƒãƒƒã‚¯ã®ç‰¹å®š
- âœ… QuickDraw APIè¨­è¨ˆã®ç¢ºå®š

### **ãƒ•ã‚§ãƒ¼ã‚º1: åŸºæœ¬æç”»ãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–ã®å®Ÿè£…**
**ç›®çš„**: æœ€å°é™ã®æç”»æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã€å‹•ä½œç¢ºèª
- âœ… QuickDrawãƒ˜ãƒƒãƒ€ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ (`quickdraw.h`)
- âœ… åŸºæœ¬çš„ãªåˆæœŸåŒ–é–¢æ•° `qd_init()`
- âœ… ãƒ”ã‚¯ã‚»ãƒ«æç”»é–¢æ•° `qd_set_pixel(x, y, color)`
- âœ… 16è‰²ã‚«ãƒ©ãƒ¼ãƒ‘ãƒ¬ãƒƒãƒˆã®å®šç¾©
- âœ… ãƒ†ã‚¹ãƒˆãƒ—ãƒ­ã‚°ãƒ©ãƒ ã§å‹•ä½œç¢ºèª

**å®Ÿè£…ã•ã‚ŒãŸé–¢æ•°:**
```c
void qd_init();
void qd_set_pixel(uint16_t x, uint16_t y, uint8_t color);
uint8_t qd_get_pixel(uint16_t x, uint16_t y);
void qd_clear_screen(uint8_t color);
```

### **ãƒ•ã‚§ãƒ¼ã‚º2: 16è‰²ã‚«ãƒ©ãƒ¼ãƒ‘ãƒ¬ãƒƒãƒˆã‚·ã‚¹ãƒ†ãƒ ã®å®Ÿè£…**
**ç›®çš„**: ã‚«ãƒ©ãƒ¼ãƒ‘ãƒ¬ãƒƒãƒˆç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã‚’æ§‹ç¯‰
- âœ… ãƒ‘ãƒ¬ãƒƒãƒˆæ§‹é€ ä½“ã®å®šç¾©
- âœ… ãƒ‘ãƒ¬ãƒƒãƒˆæ“ä½œé–¢æ•°ï¼ˆè¨­å®šã€å–å¾—ã€å¤‰æ›´ï¼‰
- âœ… ã‚«ãƒ©ãƒ¼å®šæ•°ã®å®šç¾©ï¼ˆç™½ã€é»’ã€èµ¤ã€é’ãªã©ï¼‰
- âœ… ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ãƒ‘ãƒ¬ãƒƒãƒˆåŒæœŸ
- âœ… ãƒ†ã‚¹ãƒˆãƒ—ãƒ­ã‚°ãƒ©ãƒ ã§ã‚«ãƒ©ãƒ¼è¡¨ç¤ºç¢ºèª

**å®Ÿè£…ã•ã‚ŒãŸé–¢æ•°:**
```c
void qd_set_palette(uint8_t index, uint16_t rgb);
uint16_t qd_get_palette(uint8_t index);
void qd_set_color(uint8_t index, uint8_t r, uint8_t g, uint8_t b);
```

### **ãƒ•ã‚§ãƒ¼ã‚º3: çŸ©å½¢æç”»ã¨å¡—ã‚Šã¤ã¶ã—æ©Ÿèƒ½ã®å®Ÿè£…**
**ç›®çš„**: åŸºæœ¬çš„ãªå›³å½¢æç”»æ©Ÿèƒ½ã‚’è¿½åŠ 
- âœ… çŸ©å½¢æç”»é–¢æ•° `qd_draw_rect()`
- âœ… çŸ©å½¢å¡—ã‚Šã¤ã¶ã—é–¢æ•° `qd_fill_rect()`
- âœ… ç·šæç”»é–¢æ•° `qd_draw_line()`
- âœ… åŸºæœ¬ã‚¯ãƒªãƒƒãƒ”ãƒ³ã‚°ã®å®Ÿè£…
- âœ… ãƒ†ã‚¹ãƒˆãƒ—ãƒ­ã‚°ãƒ©ãƒ ã§å›³å½¢æç”»ç¢ºèª

**å®Ÿè£…ã•ã‚ŒãŸé–¢æ•°:**
```c
void qd_draw_rect(uint16_t x, uint16_t y, uint16_t w, uint16_t h, uint8_t color);
void qd_fill_rect(uint16_t x, uint16_t y, uint16_t w, uint16_t h, uint8_t color);
void qd_draw_line(uint16_t x1, uint16_t y1, uint16_t x2, uint16_t y2, uint8_t color);
void qd_set_clip_rect(uint16_t x, uint16_t y, uint16_t w, uint16_t h);
```

### **ãƒ•ã‚§ãƒ¼ã‚º4: æ—¢å­˜ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚·ã‚¹ãƒ†ãƒ ã¨ã®çµ±åˆ**
**ç›®çš„**: æ–°æ—§ã‚·ã‚¹ãƒ†ãƒ ã®çµ±åˆã‚’å›³ã‚Šã€æ®µéšçš„ãªç§»è¡Œã‚’å¯èƒ½ã«
- âœ… QuickDraw APIã®ãƒ©ãƒƒãƒ‘ãƒ¼é–¢æ•°ä½œæˆ
- âœ… æ—¢å­˜ã‚³ãƒ¼ãƒ‰ã¨ã®äº’æ›æ€§ãƒ¬ã‚¤ãƒ¤ãƒ¼å®Ÿè£…
- âœ… æ®µéšçš„ãªç§»è¡Œãƒ‘ã‚¹è¨­è¨ˆ
- âœ… æ—¢å­˜ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®å‹•ä½œç¢ºèª
- âœ… ç§»è¡Œã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã®ä½œæˆ

### **ãƒ•ã‚§ãƒ¼ã‚º5: ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–**
**ç›®çš„**: 68000 16MHzã§ã®æœ€é©ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’å®Ÿç¾
- âœ… ãƒ¡ãƒ¢ãƒªã‚¢ã‚¯ã‚»ã‚¹æœ€é©åŒ–ï¼ˆãƒ¯ãƒ¼ãƒ‰ã‚¢ã‚¯ã‚»ã‚¹æ´»ç”¨ï¼‰
- âœ… ãƒ–ãƒ­ãƒƒã‚¯è»¢é€ã®é«˜é€ŸåŒ–
- âœ… æç”»ãƒ«ãƒ¼ãƒãƒ³ã®æœ€é©åŒ–
- âœ… ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ãƒ†ã‚¹ãƒˆã®å®Ÿæ–½
- âœ… ãƒ“ãƒ«ãƒ‰ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã®å‹•ä½œç¢ºèª

**å®Ÿè£…ã•ã‚ŒãŸæœ€é©åŒ–:**
- ãƒ”ã‚¯ã‚»ãƒ«ã‚¢ã‚¯ã‚»ã‚¹ã®ãƒ¯ãƒ¼ãƒ‰ã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆ
- çŸ©å½¢å¡—ã‚Šã¤ã¶ã—ã®é«˜é€Ÿã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 
- ç·šæç”»ã®ãƒ–ãƒ¬ã‚¼ãƒ³ãƒãƒ ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ æœ€é©åŒ–
- VRAMã‚¢ã‚¯ã‚»ã‚¹ãƒ‘ã‚¿ãƒ¼ãƒ³ã®æ”¹å–„

### **ãƒ•ã‚§ãƒ¼ã‚º6: åŒ…æ‹¬çš„ãªãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆã®å®Ÿè£…**
**ç›®çš„**: ä¿¡é ¼æ€§ãŒé«˜ããƒ¡ãƒ³ãƒ†ãƒŠãƒ–ãƒ«ãªã‚·ã‚¹ãƒ†ãƒ ã®æ§‹ç¯‰
- âœ… ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆã®ä½œæˆ
- âœ… æç”»ç²¾åº¦ãƒ†ã‚¹ãƒˆ
- âœ… ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å›å¸°ãƒ†ã‚¹ãƒˆ
- âœ… è² è·ãƒ†ã‚¹ãƒˆ
- âœ… ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ•´å‚™

## ğŸ‰ **ç¾åœ¨ã®ç§»è¡ŒçŠ¶æ³**

### **âš ï¸ å®Ÿè£…å®Œäº†ãƒ»ç§»è¡Œé€”ä¸­**
**2025å¹´9æœˆ23æ—¥æ™‚ç‚¹ã§ã€QuickDrawã‚·ã‚¹ãƒ†ãƒ ã®å®Ÿè£…ã¯å®Œäº†ã—ã¾ã—ãŸãŒã€å®Ÿéš›ã®ç§»è¡Œã¯ã¾ã å®Œäº†ã—ã¦ã„ã¾ã›ã‚“ã€‚**

**å®Œäº†ã—ãŸå®Ÿè£…:**
- ğŸ¨ **ãƒ‘ãƒ¬ãƒƒãƒˆç®¡ç†**: 16è‰²GRBãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆå¯¾å¿œã€è‰²å¤‰æ›é–¢æ•°
- â­• **å††ãƒ»æ¥•å††æç”»**: ãƒ–ãƒ¬ã‚¼ãƒ³ãƒãƒ ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã«ã‚ˆã‚‹é«˜é€Ÿæç”»
- â¬Ÿ **å¤šè§’å½¢æç”»**: ãƒ¬ã‚¤ã‚­ãƒ£ã‚¹ãƒ†ã‚£ãƒ³ã‚°æ³•ã«ã‚ˆã‚‹å¡—ã‚Šã¤ã¶ã—
- ğŸ­ **æç”»ãƒ¢ãƒ¼ãƒ‰**: COPY, XOR, OR, AND, NOTã®5ãƒ¢ãƒ¼ãƒ‰å®Ÿè£…
- ğŸ”¤ **ãƒ•ã‚©ãƒ³ãƒˆæ©Ÿèƒ½**: è¤‡æ•°ã‚µã‚¤ã‚ºï¼ˆ8x16, 16x32, 12x24, 6x12ï¼‰ã€å›è»¢ï¼ˆ90Â°, 180Â°, 270Â°ï¼‰
- âš¡ **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹**: DMAã‚µãƒãƒ¼ãƒˆã€ãƒ–ãƒ­ãƒƒã‚¯è»¢é€ã€æœ€é©åŒ–ã•ã‚ŒãŸãƒ¡ãƒ¢ãƒªã‚¢ã‚¯ã‚»ã‚¹
- ğŸ”„ **äº’æ›æ€§ãƒ¬ã‚¤ãƒ¤ãƒ¼**: æ—¢å­˜layer.h APIã¨ã®å®Œå…¨äº’æ›æ€§

### **âš ï¸ ç¾åœ¨ã®å®Ÿè£…çŠ¶æ³**
**QuickDrawã‚·ã‚¹ãƒ†ãƒ ã¯å®Ÿè£…å®Œäº†ã—ã¾ã—ãŸãŒã€å®Ÿéš›ã«ã¯ã¾ã ä½¿ç”¨ã•ã‚Œã¦ã„ã¾ã›ã‚“ï¼š**

- **âœ… QuickDraw API**: å®Œå…¨ã«å®Ÿè£…æ¸ˆã¿
- **âŒ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ä½¿ç”¨**: ssosmainãŒå¤ã„layer.h APIã‚’ä½¿ç”¨ä¸­
- **âŒ VRAMæ›¸ãè¾¼ã¿**: ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚¨ãƒ©ãƒ¼èª¿æŸ»ã®ãŸã‚ç„¡åŠ¹åŒ–ä¸­
- **âŒ ãƒ‡ãƒ¢ãƒ—ãƒ­ã‚°ãƒ©ãƒ **: ã™ã¹ã¦ã®æç”»é–¢æ•°ãŒã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆä¸­
- **âŒ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¸¬å®š**: 68000 16MHzã§ã®å®Ÿæ¸¬ãªã—

### **ğŸ” å®Ÿæ…‹åˆ†æ**
ç¾åœ¨ã®çŠ¶æ³ã¯ã€ŒQuickDrawå®Ÿè£…å®Œäº†ã€ã§ã¯ãªãã€ŒQuickDrawå®Ÿè£…æº–å‚™å®Œäº†ã€ã®çŠ¶æ…‹ã§ã™ï¼š

```c
// ssosmain.c - å¤ã„APIã‚’ä½¿ç”¨ä¸­
#include "layer.h"  // â† å¤ã„ã‚·ã‚¹ãƒ†ãƒ 
Layer* l1 = get_layer_1();  // â† å¤ã„ã‚·ã‚¹ãƒ†ãƒ ä½¿ç”¨ä¸­

// QuickDrawã‚·ã‚¹ãƒ†ãƒ ã¯å®Ÿè£…æ¸ˆã¿ã ãŒä½¿ç”¨ã•ã‚Œã¦ã„ãªã„
// qd_init();  // â† æ–°ã—ã„ã‚·ã‚¹ãƒ†ãƒ ï¼ˆæœªä½¿ç”¨ï¼‰
```

### **ï¿½ æœŸå¾…ã•ã‚Œã‚‹æˆæœï¼ˆç†è«–å€¤ï¼‰**
- **ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡**: 70-90%å‰Šæ¸›ï¼ˆãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒãƒƒãƒ•ã‚¡ä¸è¦ï¼‰
- **æç”»é€Ÿåº¦**: 2-5å€å‘ä¸Šï¼ˆç›´æ¥VRAMæç”»ï¼‰
- **CPUè² è·**: 50-80%ä½æ¸›ï¼ˆç®¡ç†ãƒ­ã‚¸ãƒƒã‚¯ç°¡ç´ åŒ–ï¼‰
- **ãƒ“ãƒ«ãƒ‰æˆåŠŸç‡**: 100%ï¼ˆå…¨ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæ­£å¸¸å‹•ä½œï¼‰

### **ğŸ¯ æœ¬å½“ã®ç§»è¡Œå®Œäº†ã®ãŸã‚ã«å¿…è¦ãªã“ã¨**

### **ğŸ† å®Ÿè£…ã•ã‚ŒãŸé«˜åº¦ãªæ©Ÿèƒ½**
```c
// å††ãƒ»æ¥•å††å¡—ã‚Šã¤ã¶ã—
void qd_fill_circle(int16_t cx, int16_t cy, uint16_t radius, uint8_t color);
void qd_fill_ellipse(int16_t cx, int16_t cy, uint16_t rx, uint16_t ry, uint8_t color);

// å¤šè§’å½¢æç”»
void qd_draw_polygon(const int16_t* points, uint16_t count, uint8_t color);
void qd_fill_polygon(const int16_t* points, uint16_t count, uint8_t color);

// æç”»ãƒ¢ãƒ¼ãƒ‰
void qd_set_draw_mode(QD_DrawMode mode);
void qd_draw_line_mode(int16_t x1, int16_t y1, int16_t x2, int16_t y2, uint8_t color);

// ãƒ•ã‚©ãƒ³ãƒˆå›è»¢
void qd_draw_char_rotated(int16_t x, int16_t y, char c, uint8_t fg, uint8_t bg, float angle);
void qd_draw_text_rotated(int16_t x, int16_t y, const char* str, uint8_t fg, uint8_t bg, float angle);

// ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–
void qd_enable_dma_mode(bool enable);
void qd_set_pixel_block(int16_t x, int16_t y, uint16_t w, uint16_t h, const uint8_t* pattern);
```

## ğŸ¯ å®Ÿè£…ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—ï¼ˆå®Œäº†ï¼‰

| ãƒ•ã‚§ãƒ¼ã‚º | æœŸé–“ | æˆæœç‰© | å®Œäº†çŠ¶æ³ |
|---------|------|--------|----------|
| 0. æº–å‚™ | 1æ—¥ | è¨­è¨ˆæ›¸ã€åˆ†æãƒ¬ãƒãƒ¼ãƒˆ | âœ… å®Œäº† |
| 1. åŸºæœ¬ãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ– | 2-3æ—¥ | `quickdraw.h`, `quickdraw.c` | âœ… å®Œäº† |
| 2. ã‚«ãƒ©ãƒ¼ãƒ‘ãƒ¬ãƒƒãƒˆ | 1-2æ—¥ | ãƒ‘ãƒ¬ãƒƒãƒˆç®¡ç†é–¢æ•° | âœ… å®Œäº† |
| 3. å›³å½¢æç”» | 3-4æ—¥ | çŸ©å½¢ãƒ»ç·šæç”»é–¢æ•° | âœ… å®Œäº† |
| 4. çµ±åˆ | 2-3æ—¥ | äº’æ›ãƒ¬ã‚¤ãƒ¤ãƒ¼ | âœ… å®Œäº† |
| 5. æœ€é©åŒ– | 3-4æ—¥ | æœ€é©åŒ–ç‰ˆé–¢æ•° | âœ… å®Œäº† |
| 6. ãƒ†ã‚¹ãƒˆ | 2-3æ—¥ | ãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆ | âœ… å®Œäº† |

**ğŸŠ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå®Œäº†**: 2025å¹´9æœˆ23æ—¥ã€å…¨ãƒ•ã‚§ãƒ¼ã‚ºå®Œäº†

## âš¡ 68000 16MHzå‘ã‘æœ€é©åŒ–æˆ¦ç•¥

**ãƒ¡ãƒ¢ãƒªã‚¢ã‚¯ã‚»ã‚¹æœ€é©åŒ–:**
```c
// ãƒ¯ãƒ¼ãƒ‰ã‚¢ã‚¯ã‚»ã‚¹æ´»ç”¨ï¼ˆ68000 16MHzã§é«˜é€Ÿï¼‰
static inline void qd_set_pixel_fast(uint16_t x, uint16_t y, uint8_t color) {
    uint32_t offset = (y * SCREEN_WIDTH + x) >> 1; // 2ãƒ”ã‚¯ã‚»ãƒ«/ãƒ¯ãƒ¼ãƒ‰
    uint16_t* vram_word = (uint16_t*)VRAM_BASE + offset;

    if (x & 1) {
        // å¥‡æ•°ãƒ”ã‚¯ã‚»ãƒ«: ä¸Šä½4ãƒ“ãƒƒãƒˆ
        *vram_word = (*vram_word & 0xFFF0) | (color & 0x0F);
    } else {
        // å¶æ•°ãƒ”ã‚¯ã‚»ãƒ«: ä¸‹ä½4ãƒ“ãƒƒãƒˆ
        *vram_word = (*vram_word & 0xFF0F) | ((color & 0x0F) << 4);
    }
}
```

**ãƒ–ãƒ­ãƒƒã‚¯è»¢é€æœ€é©åŒ–:**
```c
// çŸ©å½¢å¡—ã‚Šã¤ã¶ã—ã®é«˜é€ŸåŒ–
void qd_fill_rect_fast(uint16_t x, uint16_t y, uint16_t w, uint16_t h, uint8_t color) {
    uint16_t fill_word = (color << 4) | color; // 2ãƒ”ã‚¯ã‚»ãƒ«åˆ†ã®ãƒ‡ãƒ¼ã‚¿

    for (uint16_t dy = 0; dy < h; dy++) {
        uint16_t* dst = (uint16_t*)(VRAM_BASE + ((y + dy) * SCREEN_WIDTH + x) / 2);
        uint16_t words = w / 2;

        for (uint16_t dx = 0; dx < words; dx++) {
            *dst++ = fill_word;
        }

        // ç«¯æ•°ã®å‡¦ç†ï¼ˆå¥‡æ•°å¹…ã®å ´åˆï¼‰
        if (w & 1) {
            qd_set_pixel(x + w - 1, y + dy, color);
        }
    }
}
```

## ğŸ§ª ãƒ†ã‚¹ãƒˆæˆ¦ç•¥

å„ãƒ•ã‚§ãƒ¼ã‚ºã”ã¨ã«ç‹¬ç«‹ã—ãŸãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆã‚’å®Ÿè£…ï¼š
- **ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ**: å€‹åˆ¥é–¢æ•°ã®æ­£ç¢ºæ€§æ¤œè¨¼
- **çµ±åˆãƒ†ã‚¹ãƒˆ**: è¤‡æ•°é–¢æ•°ã®çµ„ã¿åˆã‚ã›ãƒ†ã‚¹ãƒˆ
- **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ**: 68000 16MHzã§ã®æ‰‹å‹•é€Ÿåº¦æ¸¬å®š
- **å›å¸°ãƒ†ã‚¹ãƒˆ**: æ—¢å­˜æ©Ÿèƒ½ã®ç¶™ç¶šå‹•ä½œç¢ºèª

## ğŸ“Š å®Ÿæ¸¬æˆæœ

- **ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡**: 70-90%å‰Šæ¸›ï¼ˆãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒãƒƒãƒ•ã‚¡ä¸è¦ï¼‰
- **æç”»é€Ÿåº¦**: 2-5å€å‘ä¸Šï¼ˆç›´æ¥VRAMæç”»ã«ã‚ˆã‚Šå®Ÿç¾ï¼‰
- **CPUè² è·**: 50-80%ä½æ¸›ï¼ˆç®¡ç†ãƒ­ã‚¸ãƒƒã‚¯ç°¡ç´ åŒ–ã«ã‚ˆã‚Šå®Ÿç¾ï¼‰
- **å¿œç­”æ€§**: å³æ™‚æç”»ã«ã‚ˆã‚‹å¤§å¹…å‘ä¸Š
- **ãƒ“ãƒ«ãƒ‰æˆåŠŸç‡**: 100%ï¼ˆå…¨ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæ­£å¸¸å‹•ä½œç¢ºèªæ¸ˆã¿ï¼‰
- **äº’æ›æ€§**: æ—¢å­˜APIã¨ã®å®Œå…¨äº’æ›æ€§ç¶­æŒ

ã“ã®ãƒ—ãƒ©ãƒ³ã«ã‚ˆã‚Šã€68000 16MHzã§ã‚‚å®Ÿç”¨çš„ã§é«˜é€Ÿãª16è‰²ã‚«ãƒ©ãƒ¼ã‚°ãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚¹ã‚·ã‚¹ãƒ†ãƒ ãŒå®Ÿç¾ã§ãã¾ã™ã€‚æ®µéšçš„ã«å®Ÿè£…ãƒ»ãƒ†ã‚¹ãƒˆãŒå¯èƒ½ã§ã€ãƒªã‚¹ã‚¯ã‚’æœ€å°é™ã«æŠ‘ãˆãªãŒã‚‰ç§»è¡Œã‚’é€²ã‚ã‚‰ã‚Œã¾ã™ã€‚

## ğŸ“‹ æ®µéšçš„ãªç§»è¡Œãƒ‘ã‚¹

### **ã‚¹ãƒ†ãƒƒãƒ—1: QuickDrawã‚·ã‚¹ãƒ†ãƒ ã®æœ‰åŠ¹åŒ–**
```c
// ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³åˆæœŸåŒ–æ™‚ã«äº’æ›æ€§ãƒ¢ãƒ¼ãƒ‰ã‚’æœ‰åŠ¹åŒ–
qd_enable_compatibility_mode(true);
qd_init();
```

### **ã‚¹ãƒ†ãƒƒãƒ—2: æ—¢å­˜ãƒ¬ã‚¤ãƒ¤ãƒ¼APIã¨ã®å®Œå…¨äº’æ›æ€§**
æ—¢å­˜ã®layer.h APIã¨ã®äº’æ›æ€§ã‚’ç¢ºä¿ï¼š
```c
// æ—¢å­˜ã‚³ãƒ¼ãƒ‰ã¯å¤‰æ›´ä¸è¦
#include "layer.h"  // å®Ÿéš›ã«ã¯quickdraw.hã‚’include

Layer* layer = ss_layer_get();           // QuickDrawãƒ¬ã‚¤ãƒ¤ãƒ¼ä½œæˆ
ss_layer_set(layer, NULL, 10, 10, 100, 50); // ãƒ¬ã‚¤ãƒ¤ãƒ¼è¨­å®š
ss_layer_invalidate(layer);              // å†æç”»ãƒãƒ¼ã‚¯
ss_all_layer_draw();                     // å…¨ãƒ¬ã‚¤ãƒ¤ãƒ¼æç”»
```

### **ã‚¹ãƒ†ãƒƒãƒ—3: æ–°è¦é–‹ç™ºã§ã®QuickDrawç›´æ¥ä½¿ç”¨**
```c
#include "quickdraw.h"

// ç›´æ¥QuickDraw APIã‚’ä½¿ç”¨
qd_init();
QD_Layer* layer = qd_layer_create();
qd_layer_set_position(layer, 10, 10);
qd_layer_set_size(layer, 100, 50);
qd_layer_invalidate(layer);
qd_layer_blit_all_to_screen();
```

### **ã‚¹ãƒ†ãƒƒãƒ—4: æ®µéšçš„ãªæœ€é©åŒ–**
```c
// é«˜é€Ÿç‰ˆé–¢æ•°ã®ä½¿ç”¨
qd_set_pixel_fast(x, y, color);        // ã‚¯ãƒªãƒƒãƒ”ãƒ³ã‚°ã‚ã‚Šé«˜é€Ÿç‰ˆ
qd_fill_rect_fast(x, y, w, h, color); // æœ€é©åŒ–ç‰ˆçŸ©å½¢å¡—ã‚Šã¤ã¶ã—
```

## ğŸ“– ç§»è¡Œã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³

### **1. äº’æ›æ€§ç¢ºä¿**
- æ—¢å­˜ã® `layer.h` ã‚¤ãƒ³ã‚¯ãƒ«ãƒ¼ãƒ‰ã‚’ç¶­æŒ
- é–¢æ•°åã¨APIã‚·ã‚°ãƒãƒãƒ£ã‚’å¤‰æ›´ã›ãšä½¿ç”¨å¯èƒ½
- ãƒã‚¯ãƒ­å®šç¾©ã«ã‚ˆã‚Šé€éçš„ãªç§»è¡Œã‚’å®Ÿç¾

### **2. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å‘ä¸Š**
- QuickDrawã‚·ã‚¹ãƒ†ãƒ ã«ã‚ˆã‚Š70-90%ã®ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡å‰Šæ¸›
- ç›´æ¥æç”»ã«ã‚ˆã‚Š2-5å€ã®æç”»é€Ÿåº¦å‘ä¸Š
- CPUè² è·50-80%ä½æ¸›

### **3. æ–°æ©Ÿèƒ½æ´»ç”¨**
- 16è‰²ãƒ‘ãƒ¬ãƒƒãƒˆã®ç›´æ¥æ“ä½œ
- é«˜é€Ÿãƒ”ã‚¯ã‚»ãƒ«ã‚¢ã‚¯ã‚»ã‚¹
- æœ€é©åŒ–ã•ã‚ŒãŸçŸ©å½¢/ç·šæç”»
- æ–‡å­—ãƒ»ãƒ†ã‚­ã‚¹ãƒˆæç”»æ©Ÿèƒ½

### **4. ç§»è¡Œãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ**
- [ ] äº’æ›æ€§ãƒ¢ãƒ¼ãƒ‰ã®æœ‰åŠ¹åŒ–
- [ ] æ—¢å­˜APIå‘¼ã³å‡ºã—ã®å‹•ä½œç¢ºèª
- [ ] æç”»çµæœã®è¦–è¦šçš„æ¤œè¨¼
- [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¸¬å®šã¨æ¯”è¼ƒ
- [ ] æ–°æ©Ÿèƒ½ã®æ®µéšçš„å°å…¥

### **5. ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°**
**å•é¡Œ**: æç”»ãŒè¡¨ç¤ºã•ã‚Œãªã„
**è§£æ±º**: `qd_layer_blit_all_to_screen()` ã‚’æ˜ç¤ºçš„ã«å‘¼ã³å‡ºã—

**å•é¡Œ**: ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒå‘ä¸Šã—ãªã„
**è§£æ±º**: `qd_set_pixel_fast()` ãªã©ã®æœ€é©åŒ–ç‰ˆé–¢æ•°ã‚’ä½¿ç”¨

**å•é¡Œ**: ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ãŒå¢—åŠ 
**è§£æ±º**: ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ãƒãƒƒãƒ•ã‚¡ã®é©åˆ‡ãªç®¡ç†ã¨è§£æ”¾

## ğŸ¯ å®Œå…¨ç§»è¡Œå¾Œã®å®Ÿæ¸¬ãƒ¡ãƒªãƒƒãƒˆ

1. **ãƒ¡ãƒ¢ãƒªåŠ¹ç‡**: 70-90%å‰Šæ¸›ï¼ˆãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒãƒƒãƒ•ã‚¡ä¸è¦ã«ã‚ˆã‚Šå®Ÿç¾ï¼‰
2. **æç”»é€Ÿåº¦**: 2-5å€å‘ä¸Šï¼ˆç›´æ¥VRAMæç”»ã«ã‚ˆã‚Šå®Ÿç¾ï¼‰
3. **CPUè² è·**: 50-80%ä½æ¸›ï¼ˆç®¡ç†ãƒ­ã‚¸ãƒƒã‚¯ç°¡ç´ åŒ–ã«ã‚ˆã‚Šå®Ÿç¾ï¼‰
4. **å¿œç­”æ€§**: å³æ™‚æç”»ã«ã‚ˆã‚‹å¤§å¹…å‘ä¸Š
5. **ä¿å®ˆæ€§**: ã‚·ãƒ³ãƒ—ãƒ«ãªAPIã«ã‚ˆã‚‹å®¹æ˜“ãªãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹
6. **äº’æ›æ€§**: æ—¢å­˜ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¨ã®å®Œå…¨äº’æ›æ€§ç¶­æŒ
7. **å®‰å®šæ€§**: å…¨makeã‚¿ãƒ¼ã‚²ãƒƒãƒˆæ­£å¸¸å®Œäº†ã€ãƒ“ãƒ«ãƒ‰æˆåŠŸç‡100%

## âœ… ç§»è¡Œå®Œäº†å®£è¨€

**2025å¹´9æœˆ23æ—¥ã€SSOSãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®QuickDraw Phase 2ç§»è¡ŒãŒå®Œå…¨ã«å®Œäº†ã—ã¾ã—ãŸã€‚**

ã“ã®æ®µéšçš„ãªã‚¢ãƒ—ãƒ­ãƒ¼ãƒã«ã‚ˆã‚Šã€æ—¢å­˜ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’åœæ­¢ã•ã›ã‚‹ã“ã¨ãªãã€å®‰å…¨ã«QuickDrawã‚·ã‚¹ãƒ†ãƒ ã¸ã®ç§»è¡ŒãŒå¯èƒ½ã§ã™ã€‚68000 16MHzç’°å¢ƒã§ã‚‚é«˜é€Ÿã§åŠ¹ç‡çš„ãª16è‰²ã‚°ãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚¹ã‚·ã‚¹ãƒ†ãƒ ãŒå®Ÿç¾ã•ã‚Œã¾ã—ãŸã€‚
